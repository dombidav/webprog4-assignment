<ion-header>
  <ion-toolbar>
    <ion-title>Details</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <p-card *ngIf="team">
    <ng-template pTemplate="header">
      <div class="px-4 pt-3">
        <h3>{{ team?.name }}</h3>
      </div>
    </ng-template>
    <ng-template pTemplate="content">
      <div class="ion-padding">
        <p>
          <strong>Name:</strong> {{ team.name }}
        </p>
        <p>
          <strong>Created:</strong> {{ team.created_at | date: 'yyyy-MM-dd hh:mm' }}
        </p>
        <p>
          <strong>Team leader: </strong> <a href="user/{{team.user?.id}}">{{ team.user?.name }}</a> (<a
          href="mailto:{{team.user?.email}}">{{ team.user?.email }}</a>)
        </p>
      </div>
    </ng-template>
  </p-card>
  <p-card *ngIf="team">
    <ng-template pTemplate="header">
      <div class="px-4 pt-3">
        <h3>Members</h3>
      </div>
    </ng-template>
    <ng-template pTemplate="content">
      <div class="ion-padding">
        <table class="w-100">
          <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th class="d-none d-md-block">Registered</th>
            <th>Operations</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>{{ team.user?.name }}</td>
            <td>{{ team.user?.email }}</td>
            <td class="d-none d-md-block">{{ team.user?.created_at | date: 'yyyy-MM-dd hh:mm' }}</td>
            <td>
              <button class="p-button-rounded p-button-danger p-button-outlined" icon="pi pi-times" pButton
                      type="button"></button>
            </td>
          </tr>
          <tr *ngFor="let member of team.users">
            <td><a href="user/{{member.id}}">{{ member.name }}</a></td>
            <td><a href="mailto:{{member.email}}">{{ member.email }}</a></td>
            <td class="d-none d-md-block">{{ member.created_at | date: 'yyyy-MM-dd hh:mm' }}</td>
            <td>
              <button (click)="removeMember(member.email)" class="p-button-rounded p-button-danger p-button-outlined" icon="pi pi-times"
                      pButton
                      type="button"></button>
            </td>
          </tr>
          </tbody>
        </table>
        <div class="pt-3" style="text-align: center">
          <button (click)="showDialog()" class="p-button-success p-button-outlined" icon="pi pi-plus" label="Add" pButton
                  type="button"></button>
        </div>
      </div>
    </ng-template>
  </p-card>

  <p-dialog [(visible)]="itemDialog" [modal]="true" [style]="{width: '450px'}" header="Add user" styleClass="p-fluid">
    <ng-template pTemplate="content">
      <div class="p-field">
        <label for="name">Email</label>
        <input [(ngModel)]="email" autofocus id="name" pInputText required type="text"/>
        <small *ngIf="submitted && !email" class="p-error">Email is required.</small>
      </div>
      <p-divider></p-divider>
      <p-button (click)="hideDialog()" class="p-button-text" icon="pi pi-times" label="Cancel"></p-button>
      <p-button (click)="saveItem()" class="p-button-text" icon="pi pi-check" label="Save"></p-button>
    </ng-template>
  </p-dialog>
</ion-content>
